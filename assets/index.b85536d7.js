import{r as O,c as I,a as d,o as c,b as g,d as s,w as h,v as b,e as U,t as N,f as S,n as y,g as z,h as j,i as _,j as P,k as x,l as E}from"./vendor.04f159f0.js";const M=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))e(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function l(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(a){if(a.ep)return;a.ep=!0;const n=l(a);fetch(a.href,n)}};M();const p=O({user:{}}),B="https://oyioqvxlilouegwbeekh.supabase.co",C="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNjQzMDQ0MjY5LCJleHAiOjE5NTg2MjAyNjl9.kTzSGH01qKcDB7tuNFODKL20eBZZm8srXFI02ZVFOD8",u=I(B,C);var w=(r,t)=>{const l=r.__vccOpts||r;for(const[e,a]of t)l[e]=a;return l};const D={setup(){const r=d(!1),t=d(""),l=d("");return{loading:r,email:t,password:l,handleLogin:async()=>{try{r.value=!0;const{user:a,error:n}=await u.auth.signIn({email:t.value,password:l.value});if(n)throw n}catch(a){alert(a.error_description||a.message)}finally{r.value=!1}}}}},F={class:"col-6 form-widget"},J=s("h1",{class:"header"},"Blind Date",-1),V=s("p",{class:"description"},"Sign in via email and password below",-1),R=["value","disabled"],W=["value","disabled"];function Y(r,t,l,e,a,n){return c(),g("form",{class:"row flex flex-center",onSubmit:t[2]||(t[2]=U((...i)=>e.handleLogin&&e.handleLogin(...i),["prevent"]))},[s("div",F,[J,V,s("div",null,[h(s("input",{class:"inputField",type:"email",placeholder:"Your email","onUpdate:modelValue":t[0]||(t[0]=i=>e.email=i)},null,512),[[b,e.email]]),h(s("input",{class:"inputField",type:"password",placeholder:"Your password","onUpdate:modelValue":t[1]||(t[1]=i=>e.password=i)},null,512),[[b,e.password]])]),s("div",null,[s("input",{type:"submit",class:"button block",value:e.loading?"Loading":"Login",disabled:e.loading},null,8,R),s("input",{type:"button",class:"button block",value:e.loading?"Loading":"Sign Up",disabled:e.loading},null,8,W)])])],32)}var q=w(D,[["render",Y]]);const K={props:{path:String},emits:["upload","update:path"],setup(r,{emit:t}){const{path:l}=N(r),e=d("10em"),a=d(!1),n=d(""),i=d(),o=async()=>{try{const{data:v,error:m}=await u.storage.from("avatars").download(l.value);if(m)throw m;n.value=URL.createObjectURL(v)}catch(v){console.error("Error downloading image: ",v.message)}},f=async v=>{i.value=v.target.files;try{if(a.value=!0,!i.value||i.value.length===0)throw new Error("You must select an image to upload.");const m=i.value[0],A=m.name.split(".").pop(),k=`${`${Math.random()}.${A}`}`;let{error:L}=await u.storage.from("avatars").upload(k,m);if(L)throw L;t("update:path",k),t("upload")}catch(m){alert(m.message)}finally{a.value=!1}};return S(l,()=>{l.value&&o()}),{path:l,size:e,uploading:a,src:n,files:i,uploadAvatar:f}}},Z=["src"],G={class:"button primary block",for:"single"},T=["disabled"];function X(r,t,l,e,a,n){return c(),g("div",null,[e.src?(c(),g("img",{key:0,src:e.src,alt:"Avatar",class:"avatar image",style:y({height:e.size,width:e.size})},null,12,Z)):(c(),g("div",{key:1,class:"avatar no-image",style:y({height:e.size,width:e.size})},null,4)),s("div",{style:y({width:e.size})},[s("label",G,z(e.uploading?"Uploading ...":"Upload"),1),s("input",{style:{visibility:"hidden",position:"absolute"},type:"file",id:"single",accept:"image/*",onChange:t[0]||(t[0]=(...i)=>e.uploadAvatar&&e.uploadAvatar(...i)),disabled:e.uploading},null,40,T)],4)])}var H=w(K,[["render",X]]);const Q={components:{Avatar:H},setup(){const r=d(!0),t=d(""),l=d(""),e=d("");async function a(){try{r.value=!0,p.user=u.auth.user();let{data:o,error:f,status:v}=await u.from("profiles").select("username, website, avatar_url").eq("id",p.user.id).single();if(f&&v!==406)throw f;o&&(t.value=o.username,l.value=o.website,e.value=o.avatar_url)}catch(o){alert(o.message)}finally{r.value=!1}}async function n(){try{r.value=!0,p.user=u.auth.user();const o={id:p.user.id,username:t.value,website:l.value,avatar_url:e.value,updated_at:new Date};let{error:f}=await u.from("profiles").upsert(o,{returning:"minimal"});if(f)throw f}catch(o){alert(o.message)}finally{r.value=!1}}async function i(){try{r.value=!0;let{error:o}=await u.auth.signOut();if(o)throw o}catch(o){alert(o.message)}finally{r.value=!1}}return j(()=>{a()}),{store:p,loading:r,username:t,website:l,avatar_url:e,updateProfile:n,signOut:i}}},$=s("label",{for:"email"},"Email",-1),ee=["value"],te=s("label",{for:"username"},"Name",-1),ae=s("label",{for:"website"},"Website",-1),oe=["value","disabled"],re=["disabled"];function se(r,t,l,e,a,n){const i=_("Avatar");return c(),g("form",{class:"form-widget",onSubmit:t[4]||(t[4]=U((...o)=>e.updateProfile&&e.updateProfile(...o),["prevent"]))},[P(i,{path:e.avatar_url,"onUpdate:path":t[0]||(t[0]=o=>e.avatar_url=o),onUpload:e.updateProfile},null,8,["path","onUpload"]),s("div",null,[$,s("input",{id:"email",type:"text",value:e.store.user.email,disabled:""},null,8,ee)]),s("div",null,[te,h(s("input",{id:"username",type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>e.username=o)},null,512),[[b,e.username]])]),s("div",null,[ae,h(s("input",{id:"website",type:"website","onUpdate:modelValue":t[2]||(t[2]=o=>e.website=o)},null,512),[[b,e.website]])]),s("div",null,[s("input",{type:"submit",class:"button block primary",value:e.loading?"Loading ...":"Update",disabled:e.loading},null,8,oe)]),s("div",null,[s("button",{class:"button block",onClick:t[3]||(t[3]=(...o)=>e.signOut&&e.signOut(...o)),disabled:e.loading}," Sign Out ",8,re)])],32)}var ne=w(Q,[["render",se]]);const ie={components:{Auth:q,Profile:ne},created(){this.$workbox&&this.$workbox.addEventListener("waiting",()=>{this.showUpdateUI=!0})},setup(){return p.user=u.auth.user(),u.auth.onAuthStateChange((r,t)=>{p.user=t.user}),{store:p}}};"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js")});const le={class:"container",style:{padding:"50px 0 100px 0"}};function de(r,t,l,e,a,n){const i=_("Profile"),o=_("Auth");return c(),g("div",le,[e.store.user?(c(),x(i,{key:0})):(c(),x(o,{key:1}))])}var ue=w(ie,[["render",de]]);E(ue).mount("#app");"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw-test/sw.js",{scope:"/sw-test/"}).then(function(r){console.log("Registrierung erfolgreich. Scope ist "+r.scope)}).catch(function(r){console.log("Registrierung fehlgeschlagen mit "+r)});
